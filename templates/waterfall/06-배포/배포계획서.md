# 배포 계획서 (Deployment Plan)

| 항목 | 내용 |
|------|------|
| **프로젝트명** | [프로젝트명] |
| **문서 버전** | [v1.0] |
| **작성일** | [YYYY-MM-DD] |
| **작성자** | [작성자명 / 역할] |
| **승인자** | [승인자명 / 역할] |
| **배포 예정일** | [YYYY-MM-DD HH:MM] |

---

## 1. 배포 개요

### 1.1 배포 정보

| 항목 | 내용 |
|------|------|
| **대상 시스템** | [시스템명] |
| **배포 버전** | [v1.0.0] |
| **배포 유형** | [ ] 신규 배포 / [ ] 업그레이드 / [ ] 패치 / [ ] 핫픽스 |
| **배포 방식** | [ ] 블루-그린 배포 / [ ] 카나리 배포 / [ ] 롤링 배포 / [ ] 다운타임 배포 |
| **예상 다운타임** | [없음 / N분] |
| **배포 담당자** | [담당자명] |
| **배포 승인자** | [승인자명] |

### 1.2 배포 범위

| 구성 요소 | 현재 버전 | 배포 버전 | 변경 사항 요약 |
|-----------|-----------|-----------|---------------|
| [프론트엔드] | [v0.9.0] | [v1.0.0] | [주요 변경 사항] |
| [백엔드 API] | [v0.9.0] | [v1.0.0] | [주요 변경 사항] |
| [데이터베이스] | [v0.9.0] | [v1.0.0] | [스키마 변경 사항] |
| [인프라/설정] | [v0.9.0] | [v1.0.0] | [인프라 변경 사항] |
| [추가 구성 요소] | [버전] | [버전] | [변경 사항] |

### 1.3 전제 조건

- [ ] 테스트 결과 보고서 최종 승인 완료
- [ ] 모든 Critical/Major 결함 수정 및 검증 완료
- [ ] 코드 리뷰 및 머지 완료
- [ ] 배포 승인 획득
- [ ] 운영팀 배포 일정 공지 완료
- [ ] 롤백 계획 수립 및 검증 완료
- [ ] [추가 전제 조건]

---

## 2. 배포 환경

### 2.1 환경별 구성

#### 개발 환경 (DEV)

| 항목 | 내용 |
|------|------|
| **서버** | [서버 사양, 인스턴스 타입] |
| **호스트** | [dev.example.com] |
| **DB** | [PostgreSQL 15.x / dev-db.example.com:5432] |
| **도메인** | [dev.example.com] |
| **인증서** | [자체 서명 인증서 / Let's Encrypt] |
| **비고** | 개발 전용 |

#### 스테이징 환경 (STG)

| 항목 | 내용 |
|------|------|
| **서버** | [운영 동일 사양] |
| **호스트** | [stg.example.com] |
| **DB** | [PostgreSQL 15.x / stg-db.example.com:5432] |
| **도메인** | [stg.example.com] |
| **인증서** | [Let's Encrypt / ACM] |
| **비고** | 운영 환경 미러링 |

#### 운영 환경 (PROD)

| 항목 | 내용 |
|------|------|
| **서버** | [서버 사양, 인스턴스 타입, 수량] |
| **호스트** | [app.example.com] |
| **로드밸런서** | [ALB / NLB / Nginx / 기타] |
| **DB** | [PostgreSQL 15.x / prod-db.example.com:5432 (Primary + Replica)] |
| **캐시** | [Redis / ElastiCache / 기타] |
| **파일 스토리지** | [S3 / GCS / 기타] |
| **CDN** | [CloudFront / CloudFlare / 기타] |
| **도메인** | [www.example.com] |
| **인증서** | [ACM / DigiCert / 기타] (만료일: [YYYY-MM-DD]) |
| **모니터링** | [Datadog / Grafana / CloudWatch / 기타] |
| **로깅** | [ELK / CloudWatch Logs / 기타] |

### 2.2 인프라 체크리스트

| 항목 | 확인 내용 | 상태 | 확인자 |
|------|-----------|------|--------|
| 서버 사양 | CPU/Memory/Disk 충분 여부 | [ ] 확인 | [담당자] |
| 네트워크 | 방화벽, 보안그룹 설정 확인 | [ ] 확인 | [담당자] |
| DNS | 도메인 설정 및 전파 확인 | [ ] 확인 | [담당자] |
| SSL 인증서 | 인증서 유효기간 및 설정 확인 | [ ] 확인 | [담당자] |
| 로드밸런서 | 헬스체크, 라우팅 설정 확인 | [ ] 확인 | [담당자] |
| DB | 용량, 백업, 연결 설정 확인 | [ ] 확인 | [담당자] |
| 캐시 | 캐시 서버 상태 및 설정 확인 | [ ] 확인 | [담당자] |
| 파일 스토리지 | 버킷 설정, 권한 확인 | [ ] 확인 | [담당자] |
| CDN | 배포 경로, 캐시 설정 확인 | [ ] 확인 | [담당자] |
| 모니터링 | 알림 설정, 대시보드 구성 확인 | [ ] 확인 | [담당자] |
| 로깅 | 로그 수집 파이프라인 확인 | [ ] 확인 | [담당자] |
| 환경 변수 | 운영 환경 변수 설정 확인 | [ ] 확인 | [담당자] |
| 시크릿 관리 | API Key, 인증 정보 설정 확인 | [ ] 확인 | [담당자] |

---

## 3. 배포 절차

### 3.1 사전 작업 체크리스트

| # | 작업 | 담당자 | 예상 시간 | 완료 |
|---|------|--------|-----------|------|
| 1 | 배포 일정 관련 부서 공지 (최소 [N]영업일 전) | [담당자] | - | [ ] |
| 2 | 운영 DB 전체 백업 실행 및 검증 | [담당자] | [N]분 | [ ] |
| 3 | 파일 스토리지 백업 (필요 시) | [담당자] | [N]분 | [ ] |
| 4 | 현재 운영 버전 태그 기록 (롤백 기준점) | [담당자] | [5]분 | [ ] |
| 5 | 모니터링 알림 임시 조정 (배포 중 오탐 방지) | [담당자] | [5]분 | [ ] |
| 6 | 점검 페이지 준비 (다운타임 있는 경우) | [담당자] | [10]분 | [ ] |
| 7 | 배포 관련 팀원 대기 확인 (개발, 인프라, QA) | [담당자] | - | [ ] |
| 8 | 롤백 절차 최종 확인 | [담당자] | [10]분 | [ ] |
| 9 | 스테이징 환경 최종 배포 검증 완료 | [담당자] | [30]분 | [ ] |
| 10 | [추가 사전 작업] | [담당자] | [N]분 | [ ] |

### 3.2 배포 단계별 절차

#### Phase 1: 배포 준비

| 순서 | 작업 내용 | 명령어/작업 | 예상 시간 | 담당자 | 완료 |
|------|----------|------------|-----------|--------|------|
| 1-1 | 배포 시작 공지 | [Slack/이메일로 배포 시작 알림] | [2]분 | [담당자] | [ ] |
| 1-2 | 점검 모드 활성화 (필요 시) | `[점검 모드 활성화 명령어]` | [2]분 | [담당자] | [ ] |
| 1-3 | 현재 버전 확인 | `[버전 확인 명령어]` | [1]분 | [담당자] | [ ] |
| 1-4 | 배포 대상 아티팩트 확인 | `[빌드 아티팩트 확인]` | [2]분 | [담당자] | [ ] |

#### Phase 2: 데이터베이스 마이그레이션

| 순서 | 작업 내용 | 명령어/작업 | 예상 시간 | 담당자 | 완료 |
|------|----------|------------|-----------|--------|------|
| 2-1 | DB 마이그레이션 스크립트 확인 | `[마이그레이션 파일 목록 확인]` | [2]분 | [담당자] | [ ] |
| 2-2 | DB 백업 완료 재확인 | `[백업 확인 명령어]` | [2]분 | [담당자] | [ ] |
| 2-3 | DB 마이그레이션 실행 | `[마이그레이션 실행 명령어]` | [N]분 | [담당자] | [ ] |
| 2-4 | 마이그레이션 결과 확인 | `[마이그레이션 상태 확인]` | [2]분 | [담당자] | [ ] |
| 2-5 | 데이터 정합성 확인 쿼리 실행 | `[검증 쿼리]` | [5]분 | [담당자] | [ ] |

#### Phase 3: 애플리케이션 배포

| 순서 | 작업 내용 | 명령어/작업 | 예상 시간 | 담당자 | 완료 |
|------|----------|------------|-----------|--------|------|
| 3-1 | 프론트엔드 빌드 및 배포 | `[빌드/배포 명령어]` | [N]분 | [담당자] | [ ] |
| 3-2 | 백엔드 배포 | `[배포 명령어]` | [N]분 | [담당자] | [ ] |
| 3-3 | 배포 진행 상태 모니터링 | `[배포 상태 확인 명령어]` | [N]분 | [담당자] | [ ] |
| 3-4 | 전체 인스턴스 정상 가동 확인 | `[인스턴스 상태 확인]` | [2]분 | [담당자] | [ ] |

#### Phase 4: 검증

| 순서 | 작업 내용 | 명령어/작업 | 예상 시간 | 담당자 | 완료 |
|------|----------|------------|-----------|--------|------|
| 4-1 | 헬스체크 API 확인 | `curl -s [health-check-url]` | [1]분 | [담당자] | [ ] |
| 4-2 | 배포 버전 확인 | `curl -s [version-url]` | [1]분 | [담당자] | [ ] |
| 4-3 | 스모크 테스트 실행 | `[스모크 테스트 실행 명령어]` | [10]분 | [담당자] | [ ] |
| 4-4 | 핵심 기능 수동 확인 | [로그인, 주요 기능, 데이터 조회 확인] | [10]분 | [담당자] | [ ] |
| 4-5 | 에러 로그 확인 | `[로그 확인 명령어]` | [5]분 | [담당자] | [ ] |
| 4-6 | 모니터링 대시보드 이상 여부 확인 | [대시보드 URL 접속 확인] | [5]분 | [담당자] | [ ] |

### 3.3 데이터 마이그레이션 절차

> 해당 배포에 데이터 마이그레이션이 포함된 경우 작성합니다.

| 항목 | 내용 |
|------|------|
| **마이그레이션 필요 여부** | [ ] 예 / [ ] 아니오 |
| **마이그레이션 유형** | [ ] 스키마 변경 / [ ] 데이터 변환 / [ ] 데이터 이관 |
| **영향 범위** | [영향 받는 테이블/컬럼 목록] |
| **예상 소요 시간** | [N]분 |
| **다운타임 필요 여부** | [ ] 예 / [ ] 아니오 |

**마이그레이션 스크립트 목록**:

| 순서 | 파일명 | 설명 | 롤백 스크립트 |
|------|--------|------|---------------|
| 1 | [migration_001_add_column.sql] | [테이블에 새 컬럼 추가] | [rollback_001.sql] |
| 2 | [migration_002_data_transform.sql] | [기존 데이터 변환] | [rollback_002.sql] |
| 3 | [추가 마이그레이션] | [설명] | [롤백 스크립트] |

### 3.4 사후 작업

| # | 작업 | 담당자 | 예상 시간 | 완료 |
|---|------|--------|-----------|------|
| 1 | 점검 모드 해제 (적용한 경우) | [담당자] | [2]분 | [ ] |
| 2 | CDN 캐시 무효화 | `[캐시 무효화 명령어]` | [5]분 | [ ] |
| 3 | 모니터링 알림 복원 | [담당자] | [2]분 | [ ] |
| 4 | 배포 완료 공지 | [Slack/이메일로 배포 완료 알림] | [2]분 | [ ] |
| 5 | [N]시간 집중 모니터링 | 에러율, 응답시간, 리소스 사용량 확인 | [N]시간 | [ ] |
| 6 | 배포 기록 업데이트 (릴리스 노트 발행) | [담당자] | [15]분 | [ ] |
| 7 | [추가 사후 작업] | [담당자] | [N]분 | [ ] |

---

## 4. 롤백 계획

### 4.1 롤백 기준

다음 상황 중 하나라도 해당되면 롤백을 결정합니다:

| # | 롤백 기준 | 판단 주체 |
|---|----------|-----------|
| 1 | 스모크 테스트 실패 (핵심 기능 오류) | 배포 담당자 |
| 2 | 에러율이 배포 전 대비 [5]배 이상 증가 | 배포 담당자 |
| 3 | 평균 응답 시간이 배포 전 대비 [3]배 이상 증가 | 배포 담당자 |
| 4 | 데이터 정합성 오류 발견 | 배포 담당자 / DB 담당자 |
| 5 | 인증/인가 기능 장애 | 배포 담당자 |
| 6 | 배포 후 [30]분 이내 Critical 결함 발생 | PM / 배포 담당자 |
| 7 | [추가 롤백 기준] | [판단 주체] |

**롤백 결정 권한**: [배포 담당자] / 에스컬레이션 시 [PM/CTO]

### 4.2 롤백 절차

| 순서 | 작업 내용 | 명령어/작업 | 예상 시간 | 담당자 | 완료 |
|------|----------|------------|-----------|--------|------|
| R-1 | 롤백 결정 및 공지 | [Slack/이메일로 롤백 시작 알림] | [2]분 | [담당자] | [ ] |
| R-2 | 점검 모드 활성화 (필요 시) | `[점검 모드 활성화 명령어]` | [2]분 | [담당자] | [ ] |
| R-3 | 애플리케이션 이전 버전 배포 | `[롤백 배포 명령어]` | [N]분 | [담당자] | [ ] |
| R-4 | DB 마이그레이션 롤백 (필요 시) | `[롤백 스크립트 실행]` | [N]분 | [담당자] | [ ] |
| R-5 | 롤백 후 헬스체크 확인 | `curl -s [health-check-url]` | [1]분 | [담당자] | [ ] |
| R-6 | 롤백 후 버전 확인 | `curl -s [version-url]` | [1]분 | [담당자] | [ ] |
| R-7 | 스모크 테스트 실행 | `[스모크 테스트 명령어]` | [10]분 | [담당자] | [ ] |
| R-8 | 점검 모드 해제 | `[점검 모드 해제 명령어]` | [2]분 | [담당자] | [ ] |
| R-9 | 롤백 완료 공지 | [Slack/이메일로 롤백 완료 알림] | [2]분 | [담당자] | [ ] |
| R-10 | 롤백 원인 분석 및 보고서 작성 | [담당자] | [N]시간 | [담당자] | [ ] |

### 4.3 데이터 롤백 방법

| 시나리오 | 롤백 방법 | 데이터 영향 | 비고 |
|----------|----------|-------------|------|
| 스키마 변경만 있는 경우 | 롤백 마이그레이션 스크립트 실행 | 신규 데이터 보존 (가능 시) | |
| 데이터 변환이 있는 경우 | 변환 전 백업에서 대상 테이블 복원 | 배포 후 입력 데이터 유실 가능 | 유실 데이터 복구 절차 필요 |
| 전체 복원이 필요한 경우 | 전체 DB 백업 복원 (Point-in-Time) | 배포 시점 이후 전체 데이터 유실 | 최후 수단 |

**데이터 복구 절차** (배포 후 입력 데이터 보존 필요 시):

1. [롤백 전 현재 DB 스냅샷 생성]
2. [이전 버전으로 DB 롤백]
3. [스냅샷에서 배포 후 신규 데이터 추출]
4. [추출한 데이터를 롤백된 DB에 적용]
5. [데이터 정합성 검증]

---

## 5. 배포 일정

### 5.1 배포 일정 차트

```mermaid
gantt
    title 배포 일정
    dateFormat  YYYY-MM-DD HH:mm
    axisFormat  %H:%M

    section 사전 작업
    관련 부서 공지                 :[notice], [date] [time], 10min
    DB 백업                       :[backup], after [notice], 30min
    팀원 대기 확인                 :[standby], after [backup], 10min

    section 배포 실행
    점검 모드 활성화 (필요 시)     :[maint], after [standby], 5min
    DB 마이그레이션               :[migrate], after [maint], 20min
    프론트엔드 배포               :[fe_deploy], after [migrate], 15min
    백엔드 배포                   :[be_deploy], after [migrate], 15min

    section 검증
    헬스체크 및 버전 확인          :[health], after [be_deploy], 5min
    스모크 테스트                  :[smoke], after [health], 15min
    핵심 기능 수동 확인            :[manual], after [smoke], 15min

    section 사후 작업
    점검 모드 해제                 :[unmaint], after [manual], 5min
    CDN 캐시 무효화               :[cache], after [unmaint], 5min
    배포 완료 공지                 :[complete], after [cache], 5min
    집중 모니터링                  :[monitor], after [complete], 120min
```

> **참고**: 실제 배포 일시와 소요 시간에 맞게 수정하세요.

### 5.2 서비스 다운타임 계획

| 항목 | 내용 |
|------|------|
| **다운타임 필요 여부** | [ ] 예 / [ ] 아니오 (무중단 배포) |
| **예상 다운타임** | [N]분 (HH:MM ~ HH:MM) |
| **점검 페이지** | [점검 페이지 URL] |
| **사용자 사전 공지** | [공지 일시 및 채널] |

### 5.3 관련 부서 알림 일정

| 시점 | 알림 대상 | 알림 내용 | 채널 | 담당자 |
|------|-----------|-----------|------|--------|
| 배포 [N]일 전 | 전체 관련 부서 | 배포 일정 사전 공지 | [이메일/Slack] | [담당자] |
| 배포 [1]일 전 | 고객지원팀 | 배포 내용 및 FAQ 공유 | [이메일/Slack] | [담당자] |
| 배포 시작 시 | 개발/인프라/QA | 배포 시작 알림 | [Slack] | [담당자] |
| 배포 완료 시 | 전체 관련 부서 | 배포 완료 및 릴리스 노트 공유 | [이메일/Slack] | [담당자] |
| 롤백 시 (해당 시) | 전체 관련 부서 | 롤백 알림 및 사유 | [Slack/이메일] | [담당자] |

---

## 6. 릴리스 노트 템플릿

---

# 릴리스 노트 (Release Notes)

## [프로젝트명] v[1.0.0]

**릴리스 일자**: [YYYY-MM-DD]
**이전 버전**: [v0.9.0]

---

### 신규 기능 (New Features)

| # | 기능 | 설명 | 관련 이슈 |
|---|------|------|-----------|
| 1 | [신규 기능명] | [기능 설명] | [#이슈번호] |
| 2 | [신규 기능명] | [기능 설명] | [#이슈번호] |

### 개선 사항 (Improvements)

| # | 항목 | 설명 | 관련 이슈 |
|---|------|------|-----------|
| 1 | [개선 항목명] | [개선 내용] | [#이슈번호] |
| 2 | [개선 항목명] | [개선 내용] | [#이슈번호] |

### 버그 수정 (Bug Fixes)

| # | 수정 항목 | 설명 | 관련 이슈 |
|---|----------|------|-----------|
| 1 | [버그 제목] | [수정 내용] | [#이슈번호] |
| 2 | [버그 제목] | [수정 내용] | [#이슈번호] |

### 알려진 이슈 (Known Issues)

| # | 이슈 | 영향 | 우회 방법 | 수정 예정 |
|---|------|------|-----------|-----------|
| 1 | [이슈 설명] | [영향 범위] | [우회 방법] | [v1.0.1 예정] |

### 호환성 정보

| 항목 | 지원 버전 |
|------|-----------|
| 브라우저 | Chrome 120+, Firefox 121+, Safari 17+, Edge 120+ |
| 모바일 | iOS 17+, Android 14+ |
| Node.js | [v20.x LTS] |
| 데이터베이스 | [PostgreSQL 15.x] |

### 업그레이드 가이드

**이전 버전(v[0.9.0])에서 업그레이드 시 참고 사항**:

1. [업그레이드 단계 1: 예) 환경 변수 NEW_CONFIG 추가 필요]
2. [업그레이드 단계 2: 예) DB 마이그레이션 실행 필요]
3. [업그레이드 단계 3: 예) 캐시 초기화 필요]

**Breaking Changes**:

| 항목 | 변경 내용 | 마이그레이션 방법 |
|------|----------|------------------|
| [변경 항목] | [변경 내용] | [마이그레이션/대응 방법] |

---

## 부록

### A. 배포 이력

| 버전 | 배포일 | 배포 유형 | 주요 내용 | 비고 |
|------|--------|-----------|-----------|------|
| [v1.0.0] | [YYYY-MM-DD] | 신규 배포 | [주요 내용] | |
| [v0.9.0] | [YYYY-MM-DD] | 베타 배포 | [주요 내용] | 스테이징 |

### B. 비상 연락처

| 역할 | 담당자 | 연락처 | 비고 |
|------|--------|--------|------|
| 배포 담당 | [성명] | [전화/Slack] | 1차 연락 |
| 인프라 담당 | [성명] | [전화/Slack] | 서버/네트워크 |
| DB 담당 | [성명] | [전화/Slack] | DB 관련 |
| PM | [성명] | [전화/Slack] | 에스컬레이션 |
| CTO | [성명] | [전화/Slack] | 최종 의사결정 |

### C. 승인

| 역할 | 성명 | 서명 | 일자 |
|------|------|------|------|
| 개발 리드 | [성명] | | [YYYY-MM-DD] |
| 인프라 리드 | [성명] | | [YYYY-MM-DD] |
| QA 리드 | [성명] | | [YYYY-MM-DD] |
| PM | [성명] | | [YYYY-MM-DD] |
